window.onload=function(){!function(e,t,n){"use strict";function o(e){window.location.href="#/"+e}function r(e){var t=$.Deferred();return m.authWithOAuthPopup(e,function(e,n){e&&t.reject(e),n&&t.resolve(n)}),t.promise()}function i(e){var t=$.Deferred();return console.log(e),m.authWithPassword(e,function(e,n){e&&t.reject(e),n&&t.resolve(n)}),t.promise()}function l(e){var t=$.Deferred();return m.createUser(e,function(e){e?t.reject(e):t.resolve()}),t.promise()}function a(e){return l(e).then(function(){return i(e)})}function u(){var e=$.Deferred();return m.authAnonymously(function(t,n){n&&e.resolve(n),t&&e.reject(t)}),e.promise()}function c(e,t){$.when(e).then(function(e){o(t)},function(e){console.log(e),s({title:e.code,detail:e.message,className:"alert-danger"})})}function s(e){var t=e.title,n=e.detail,o="alert "+e.className;p.removeClass().addClass(o),p.children("#alert-title").text(t),p.children("#alert-detail").text(n)}function f(e){var t=g[e],n=m.getAuth();if(t.authRequired&&!n)return void o("register");var r=$("#"+t.form);h||(h=r),h.hide(),r.show().hide().fadeIn(750),h.off(),h=r,v[t.controller](h)}function d(){f(this.path)}var m=new t("https://projectbird.firebaseio.com/"),g={"#/":{form:"frmLogin",controller:"login"},"#/logout":{form:"frmLogout",controller:"logout"},"#/register":{form:"frmRegister",controller:"register"},"#/profile":{form:"frmProfile",controller:"profile",authRequired:!0}},v={},h=null,p=$("#alert");v.login=function(e){document.getElementById("frmLogin").style.display="block",e.on("submit",function(e){var t=$(this).serializeObject(),n=i(t);e.preventDefault(),c(n,"profile")}),e.children(".bt-social").on("click",function(e){var t,n=$(this),o=n.data("provider");e.preventDefault(),t=r(o),c(t,"profile")}),e.children("#btAnon").on("click",function(e){e.preventDefault(),c(u(),"profilex")})},v.logout=function(e){document.getElementById("frmLogin").style.display="block",m.unauth()},v.register=function(e){document.getElementById("frmLogin").style.display="none",e.on("submit",function(e){var t=$(this).serializeObject(),n=a(t);e.preventDefault(),c(n,"profile")})},v.profile=function(e){document.getElementById("frmLogin").style.display="none";var t,n=m.getAuth();return n?(t=m.child("users").child(n.uid),t.once("value",function(t){var n=t.val();n&&(e.find("#txtName").val(n.name),e.find("#ddlDino").val(n.favoriteDinosaur))}),void e.on("submit",function(e){e.preventDefault();var n=$(this).serializeObject();t.set(n,function(){s({title:"Successfully saved!",detail:"You are still logged in",className:"alert-success"})})})):void o("register")},n.map("#/").to(d),n.map("#/logout").to(d),n.map("#/register").to(d),n.map("#/profile").to(d),n.root("#/"),$(function(){n.listen(),m.onAuth(function(e){s(e?{title:"Logged in!",detail:"Using "+e.provider,className:"alert-success"}:{title:"You are not logged in",detail:"",className:"alert-info"})})})}(window.jQuery,window.Firebase,window.Path)};